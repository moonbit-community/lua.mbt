{"id":"lua.mbt-266","title":"Make sure pass all official tests under refs/lua/testes","description":"Run and pass all official Lua 5.4 test suite files from refs/lua/testes directory. These are comprehensive tests from the official Lua implementation that cover edge cases, language features, and standard library functionality.\n\nGoals:\n- Identify which tests currently pass/fail\n- Fix implementation issues to pass all tests\n- Ensure full Lua 5.4 compatibility\n\nTest files location: refs/lua/testes/*.lua","status":"in_progress","priority":1,"issue_type":"epic","created_at":"2026-01-06T20:54:18.417853+08:00","created_by":"wenyuxiang","updated_at":"2026-01-06T20:55:07.330912+08:00"}
{"id":"lua.mbt-266.1","title":"Fix multiline string/comment parsing ([[...]]) syntax","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-06T21:02:58.113211+08:00","created_by":"wenyuxiang","updated_at":"2026-01-06T14:04:11.485906928Z","closed_at":"2026-01-06T14:04:11.485906928Z","close_reason":"Fixed string escape sequences (\\z, \\u{}, backslash-newline) and hexadecimal float parsing (0x1.8p2 format)","dependencies":[{"issue_id":"lua.mbt-266.1","depends_on_id":"lua.mbt-266","type":"parent-child","created_at":"2026-01-06T21:02:58.114598+08:00","created_by":"wenyuxiang"}]}
{"id":"lua.mbt-266.2","title":"Implement goto statement and labels","status":"open","priority":0,"issue_type":"feature","created_at":"2026-01-06T21:02:58.243041+08:00","created_by":"wenyuxiang","updated_at":"2026-01-06T21:02:58.243041+08:00","dependencies":[{"issue_id":"lua.mbt-266.2","depends_on_id":"lua.mbt-266","type":"parent-child","created_at":"2026-01-06T21:02:58.243655+08:00","created_by":"wenyuxiang"}]}
{"id":"lua.mbt-266.3","title":"Fix hexadecimal float literal parsing","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-06T21:02:58.371678+08:00","created_by":"wenyuxiang","updated_at":"2026-01-06T14:04:11.509997386Z","closed_at":"2026-01-06T14:04:11.509997386Z","close_reason":"Fixed string escape sequences (\\z, \\u{}, backslash-newline) and hexadecimal float parsing (0x1.8p2 format)","dependencies":[{"issue_id":"lua.mbt-266.3","depends_on_id":"lua.mbt-266","type":"parent-child","created_at":"2026-01-06T21:02:58.372276+08:00","created_by":"wenyuxiang"}]}
{"id":"lua.mbt-266.4","title":"Implement missing standard library functions","status":"open","priority":1,"issue_type":"feature","created_at":"2026-01-06T21:02:58.505711+08:00","created_by":"wenyuxiang","updated_at":"2026-01-06T21:02:58.505711+08:00","dependencies":[{"issue_id":"lua.mbt-266.4","depends_on_id":"lua.mbt-266","type":"parent-child","created_at":"2026-01-06T21:02:58.507001+08:00","created_by":"wenyuxiang"}]}
{"id":"lua.mbt-266.5","title":"Fix register allocation bugs in compiler","status":"open","priority":0,"issue_type":"bug","created_at":"2026-01-06T21:02:58.646859+08:00","created_by":"wenyuxiang","updated_at":"2026-01-06T21:02:58.646859+08:00","dependencies":[{"issue_id":"lua.mbt-266.5","depends_on_id":"lua.mbt-266","type":"parent-child","created_at":"2026-01-06T21:02:58.647459+08:00","created_by":"wenyuxiang"}]}
{"id":"lua.mbt-266.6","title":"Fix table indexing and metatable edge cases","status":"open","priority":1,"issue_type":"bug","created_at":"2026-01-06T21:03:09.894546+08:00","created_by":"wenyuxiang","updated_at":"2026-01-06T21:03:09.894546+08:00","dependencies":[{"issue_id":"lua.mbt-266.6","depends_on_id":"lua.mbt-266","type":"parent-child","created_at":"2026-01-06T21:03:09.895308+08:00","created_by":"wenyuxiang"}]}
{"id":"lua.mbt-266.7","title":"Fix complex expression parsing issues","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-06T21:03:10.007176+08:00","created_by":"wenyuxiang","updated_at":"2026-01-06T21:03:10.007176+08:00","dependencies":[{"issue_id":"lua.mbt-266.7","depends_on_id":"lua.mbt-266","type":"parent-child","created_at":"2026-01-06T21:03:10.007836+08:00","created_by":"wenyuxiang"}]}
{"id":"lua.mbt-266.9","title":"Improve UTF-8 file reading robustness","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-06T21:03:16.127049+08:00","created_by":"wenyuxiang","updated_at":"2026-01-06T21:03:16.127049+08:00","dependencies":[{"issue_id":"lua.mbt-266.9","depends_on_id":"lua.mbt-266","type":"parent-child","created_at":"2026-01-06T21:03:16.127887+08:00","created_by":"wenyuxiang"}]}
{"id":"lua.mbt-3do","title":"Refactor cli to use moonbit async, ref https://github.com/moonbitlang/async","description":"Successfully refactored CLI to use moonbitlang/async.\n\n## Summary\n\nMigrated the Lua interpreter CLI from synchronous to async file I/O using the moonbitlang/async library by switching the build target from wasm-gc to native.\n\n## Changes Made\n\n1. **Build Target Configuration** (moon.mod.json:4)\n   - Added `\"preferred-target\": \"native\"`\n   - Re-added async dependency: `\"moonbitlang/async\": \"0.16.0\"`\n\n2. **Package Imports** (cmd/moon.pkg.json)\n   - Added `moonbitlang/async`\n   - Added `moonbitlang/async/fs`\n   - Added `moonbitlang/async/io`\n   - Removed `moonbitlang/x/fs` (replaced with async/fs)\n\n3. **Async Function Conversions** (cmd/main.mbt)\n   - `fn main` → `async fn main` (line 5)\n   - `fn handle_command` → `async fn handle_command` (line 64)\n   - `fn repl` → `async fn repl` (line 178)\n\n4. **File I/O Refactoring** (cmd/main.mbt:144-146)\n   - Replaced: `@fs.read_file_to_string(file)`\n   - With: `@fs.read_file(file).text()`\n   - Uses async file operations with proper error handling\n\n## Test Results\n\n✅ **All tests passing:**\n- **Unit tests**: 55/55 passed\n- **Integration tests**: All tested scripts execute correctly\n- **CLI features**: Version flag, file execution working\n\n## Performance \u0026 Compatibility\n\n- **Backend**: Now uses native/LLVM instead of wasm-gc\n- **Async model**: Single-threaded cooperative multitasking\n- **File I/O**: Non-blocking async reads\n- **Future-ready**: Enables potential concurrent features (parallel file loading, networked REPL)\n\n## Reference\n\n- Implementation based on https://github.com/moonbitlang/async\n- API docs: https://mooncakes.io/docs/moonbitlang/async\n- Example patterns from async/fs test suite","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-06T20:30:56.608597+08:00","created_by":"wenyuxiang","updated_at":"2026-01-06T20:50:04.715191+08:00","closed_at":"2026-01-06T20:50:04.715194+08:00"}
